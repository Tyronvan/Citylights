<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<title>Race to Level 100</title>

<script src="https://cdn.tailwindcss.com"></script>

<style>
html, body {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
    overflow: hidden;
    background: #0f172a;
    font-family: Helvetica, Arial, sans-serif;
    user-select: none;
    touch-action: none;
}

#game-container {
    position: relative;
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    background: #1e293b;
}

canvas {
    width: 100%;
    height: 100%;
    max-width: 500px;
    background: #334155;
}

#start-screen {
    position: absolute;
    inset: 0;
    background: black;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    color: white;
    z-index: 100;
    cursor: pointer;
    text-align: center;
}

#intro-overlay {
    position: absolute;
    inset: 0;
    background: black;
    z-index: 90;
    display: none;
    justify-content: center;
    align-items: center;
    flex-direction: column;
}

.intro-text {
    color: #FCBE11;
    font-weight: 900;
    font-size: clamp(30px, 8vw, 60px);
    opacity: 0;
    transition: opacity 0.5s;
}

.intro-text.visible { opacity: 1; }

.countdown-text {
    font-size: clamp(80px, 20vw, 150px);
    font-weight: 900;
    color: #FCBE11;
    opacity: 0;
    transform: scale(0.5);
    transition: all 0.2s;
}

.countdown-text.pop {
    opacity: 1;
    transform: scale(1.2);
}

.score-container {
    position: absolute;
    top: 20px;
    left: 20px;
    background: black;
    padding: 10px 15px;
    border-radius: 8px;
    color: white;
    opacity: 0;
}

#game-over {
    position: absolute;
    inset: 0;
    background: rgba(0,0,0,0.95);
    display: none;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    color: white;
    z-index: 200;
}
</style>
</head>

<body>

<audio id="bgMusic" loop preload="auto" playsinline></audio>

<div id="game-container">
<canvas id="motorCanvas"></canvas>

<div id="start-screen">
    <h1 class="text-4xl font-black mb-4 text-yellow-400">RACE TO LEVEL 100</h1>
    <p class="opacity-60 animate-pulse">TAP TO START</p>
    <p id="audio-status" class="text-xs mt-2 opacity-50">Audio laden…</p>
</div>

<div id="intro-overlay">
    <div id="intro-text-1" class="intro-text">LYNCH AUTOMATIC</div>
    <div id="intro-text-2" class="intro-text">CITYLIGHTS – DAMICO</div>
    <div id="countdown" class="countdown-text">3</div>
</div>

<div class="score-container" id="scoreContainer">
    SCORE: <span id="scoreText">0</span>
</div>

<div id="game-over">
    <h2 class="text-4xl font-black text-red-600">GAME OVER</h2>
    <p class="mt-2">Score: <span id="finalScore">0</span></p>
</div>

</div>

<script>
// ===== BASIS =====
const canvas = document.getElementById("motorCanvas");
const ctx = canvas.getContext("2d");
const bgMusic = document.getElementById("bgMusic");

const startScreen = document.getElementById("start-screen");
const introOverlay = document.getElementById("intro-overlay");
const introText1 = document.getElementById("intro-text-1");
const introText2 = document.getElementById("intro-text-2");
const countdownText = document.getElementById("countdown");
const scoreContainer = document.getElementById("scoreContainer");
const scoreText = document.getElementById("scoreText");
const gameOverScreen = document.getElementById("game-over");
const finalScore = document.getElementById("finalScore");
const audioStatus = document.getElementById("audio-status");

let width, height;
let gameState = "START";
let score = 0;

// ===== AUDIO =====
const MUSIC_URLS = ["./CITYLIGHTS.mp3"];
let currentMusicIndex = 0;

function loadNextAudio() {
    bgMusic.src = MUSIC_URLS[currentMusicIndex];
}

bgMusic.addEventListener("canplay", () => {
    audioStatus.textContent = "Audio klaar – tap om te starten";
});

bgMusic.addEventListener("error", () => {
    audioStatus.textContent = "Audio niet gevonden";
});

// ===== RESIZE =====
function resize() {
    width = Math.min(window.innerWidth, 500);
    height = window.innerHeight;
    canvas.width = width;
    canvas.height = height;
}

// ===== START =====
function handleStart() {
    if (gameState !== "START") return;
    gameState = "INTRO";
    startScreen.style.display = "none";
    introOverlay.style.display = "flex";

    bgMusic.play().catch(()=>{});

    setTimeout(()=>introText1.classList.add("visible"), 1000);
    setTimeout(()=>{
        introText1.classList.remove("visible");
        introText2.classList.add("visible");
    }, 3000);

    setTimeout(()=>{
        introText2.classList.remove("visible");
        runCountdown();
    }, 5000);
}

// ===== COUNTDOWN =====
function runCountdown() {
    let c = 3;
    countdownText.textContent = c;
    countdownText.classList.add("pop");

    const i = setInterval(()=>{
        c--;
        if (c > 0) {
            countdownText.textContent = c;
        } else {
            clearInterval(i);
            startGame();
        }
    }, 1000);
}

function startGame() {
    introOverlay.style.display = "none";
    scoreContainer.style.opacity = "1";
    gameState = "PLAYING";
}

// ===== GAME LOOP =====
function animate() {
    ctx.clearRect(0,0,width,height);

    ctx.fillStyle = "#334155";
    ctx.fillRect(0,0,width,height);

    if (gameState === "PLAYING") {
        score++;
        scoreText.textContent = score;
    }

    requestAnimationFrame(animate);
}

// ===== INIT =====
resize();
loadNextAudio();
animate();

startScreen.addEventListener("click", handleStart);
window.addEventListener("resize", resize);
</script>

</body>
</html>
